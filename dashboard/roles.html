<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="./angular.min.js"></script>
    <script src="constants.js"></script>
</head>
<body>
  <div ng-app="rolesApp" ng-controller="rolesCtrl">
    <selectable-role
      ng-repeat="role in roles"
      role="{{role}}"
      active="activeRoles"
      toggle="toggle(role)">
    </selectable-role>
  </div>
  <script>
  var app = angular.module('rolesApp', []);
  app.controller('rolesCtrl', function($scope) {
    $scope.roles = onuwRoles;
    $scope.activeRoles = [];

    $scope.toggle = function(role) {
      var index = $scope.activeRoles.indexOf(role);
      if ($scope.activeRoles.includes(role)) {
        $scope.activeRoles.splice(index, 1);
      } else {
        $scope.activeRoles.push(role);
      }
    }

    activeRolesRep.on('change', (newValue, oldValue) => {
      $scope.$apply();
    });

    NodeCG.waitForReplicants(activeRolesRep).then(() => {
      $scope.activeRoles = activeRolesRep.value;
      $scope.$apply();
    });
  });
  </script>
  <script src="./directives/selectableRole.js"></script>
</body>
</html>
